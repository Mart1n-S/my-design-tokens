import { Canvas, Meta, Controls, ArgTypes } from '@storybook/addon-docs/blocks';
import * as TextareaStories from './FormFieldTextarea.stories';

<Meta of={TextareaStories} />

# FormField (Textarea) üìù

La mol√©cule `FormField` s'adapte parfaitement aux zones de texte multilignes (`BaseTextarea`).  
En plus de la gestion standard (Label, Erreur), elle offre une fonctionnalit√© sp√©cifique pour les textes longs : **l'affichage d'un compteur de caract√®res**.

---

### Playground

Testez l'int√©gration du `BaseTextarea`. Essayez d'activer `showCount` et de d√©finir un `maxLength` pour voir le compteur appara√Ætre.

<Canvas of={TextareaStories.Playground} />
<Controls of={TextareaStories.Playground} />

---

### Cas d'usages

#### 1. Standard
Le label s'aligne au-dessus de la zone de texte. Le wrapper g√®re l'espacement vertical.

<Canvas of={TextareaStories.Standard} />

#### 2. Compteur de Caract√®res
C'est la fonctionnalit√© cl√© pour les Textareas.
* Activez la prop `show-count`.
* Fournissez `max-length` (la limite) et `current-length` (la longueur actuelle du v-model).
* Le compteur s'affiche discr√®tement en haut √† droite du champ.

<Canvas of={TextareaStories.AvecCompteur} />

#### 3. Validation & Erreur
Comme pour l'input, l'√©tat `error` colore le label et la bordure. Le message d'erreur est particuli√®rement utile ici pour expliquer des r√®gles de validation complexes (ex: "Votre message ne doit pas contenir de liens").

<Canvas of={TextareaStories.EtatErreur} />

#### 4. √âtats D√©sactiv√©s & Readonly
L'√©tat `disabled` grise le label. L'√©tat `readonly` est souvent utilis√© pour afficher des donn√©es brutes copiables (Logs, Cl√©s RSA).

<Canvas of={TextareaStories.DisabledReadonly} />

---

### API (Props)

<ArgTypes of={TextareaStories} />

---

### Do's & Don'ts

#### 1. Compteurs & Limites

<div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginTop: '20px' }}>
  
  <div style={{ background: '#f0fdf4', border: '1px solid #bbf7d0', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#166534', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚úÖ √Ä faire (Do)</p>
    <ul>
      <li><strong>Calculer la longueur :</strong> C'est au parent de calculer <code>v-model.length</code> et de le passer √† la prop <code>current-length</code>.</li>
      <li>D√©finir la prop <code>max-length</code> sur le FormField pour que le ratio (ex: 50/100) soit correct.</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Bon exemple :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField 
  label="Tweet" 
  show-count 
  :max-length="280" 
  :current-length="tweet.length"
>
  <BaseTextarea 
    v-model="tweet" 
    maxlength="280" 
  />
</FormField>`}
        </pre>
    </div>
  </div>

  <div style={{ background: '#fef2f2', border: '1px solid #fecaca', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#991b1b', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚ùå √Ä ne pas faire (Don't)</p>
    <ul>
      <li>Ne pas utiliser le compteur sans d√©finir de limite (l'utilisateur ne saura pas quand s'arr√™ter).</li>
      <li>Ne pas oublier de mettre l'attribut natif <code>maxlength</code> sur le <code>BaseTextarea</code> (sinon on peut continuer √† √©crire ind√©finiment).</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Mauvais exemple :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField show-count :current-length="10">
  <BaseTextarea />
</FormField>`}
        </pre>
    </div>
  </div>

</div>

#### 2. Ergonomie & Layout

<div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginTop: '20px' }}>
  
  <div style={{ background: '#f0fdf4', border: '1px solid #bbf7d0', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#166534', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚úÖ √Ä faire (Do)</p>
    <ul>
      <li>Utiliser <code>resize="vertical"</code> (d√©faut) pour √©viter que l'utilisateur ne casse la mise en page horizontale.</li>
      <li>D√©finir un nombre de <code>rows</code> suffisant pour le contenu attendu.</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Bon exemple :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField label="Votre message">
  <BaseTextarea 
    rows="5" 
    resize="vertical" 
  />
</FormField>`}
        </pre>
    </div>
  </div>

  <div style={{ background: '#fef2f2', border: '1px solid #fecaca', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#991b1b', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚ùå √Ä ne pas faire (Don't)</p>
    <ul>
      <li>Ne pas utiliser <code>resize="both"</code> ou <code>horizontal</code> dans un formulaire contraint en largeur (risque de d√©bordement).</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Mauvais exemple :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField label="Commentaire">
  <BaseTextarea resize="both" />
</FormField>`}
        </pre>
    </div>
  </div>

</div>

---

### Accessibilit√©

Le `FormField` assure la conformit√© WCAG pour vos zones de texte :

* **Liaison Label** : Comme pour l'input, l'attribut `for` du label doit correspondre √† l'attribut `id` du `BaseTextarea`. C'est **obligatoire**.
* **Instructions** : Les textes d'aide et messages d'erreur sont li√©s via `aria-describedby` (expos√© par le slot scope).
* **Compteur** : Le compteur visuel est informatif. Pour les lecteurs d'√©cran, assurez-vous que la limite est claire (l'attribut `maxlength` est annonc√© nativement par la plupart des navigateurs/screen readers).