import { Canvas, Meta, Controls, ArgTypes } from '@storybook/addon-docs/blocks';
import * as InputStories from './FormFieldInput.stories';

<Meta of={InputStories} />

# FormField (Input) üìù

La mol√©cule `FormField` est le conteneur standard pour les champs de saisie textuels (`BaseInput`).  
Elle assure l'accessibilit√© et la coh√©rence visuelle en g√©rant :
- Le lien **Label / Input** (via l'ID).
- L'affichage des **messages d'erreur**.
- Le lien **Description / Input** (via `aria-describedby`).

---

### Playground

Testez l'int√©gration du `BaseInput` dans le `FormField`.  
Notez comment le label r√©agit aux √©tats d'erreur et d√©sactiv√©s.

<Canvas of={InputStories.Playground} />
<Controls of={InputStories.Playground} />

---

### Cas d'usages

#### 1. Recherche & Ic√¥nes
Le FormField encadre parfaitement les inputs avec ic√¥nes (loupe, utilisateur, etc.).

<Canvas of={InputStories.StandardRecherche} />

#### 2. Mot de Passe
Exemple d'interaction complexe (Toggle Visibility) √† l'int√©rieur du wrapper. Le FormField reste passif et laisse l'input g√©rer la logique.

<Canvas of={InputStories.MotDePasse} />

#### 3. Validation & Erreur
C'est le r√¥le principal du FormField : afficher l'erreur de mani√®re uniforme.
* Le label devient rouge.
* Le message d'erreur appara√Æt sous le champ.
* L'attribut `aria-describedby` lie l'erreur au champ pour les lecteurs d'√©cran.

<Canvas of={InputStories.ValidationErreur} />

#### 4. √âtats D√©sactiv√©s & Readonly
L'√©tat `disabled` sur le FormField grise le label pour indiquer que toute la zone est inactive.

<Canvas of={InputStories.DisabledReadonly} />

---

### API (Props)

<ArgTypes of={InputStories} />

---

### Do's & Don'ts

#### 1. Structure & Liens

<div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginTop: '20px' }}>
  
  <div style={{ background: '#f0fdf4', border: '1px solid #bbf7d0', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#166534', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚úÖ √Ä faire (Do)</p>
    <ul>
      <li><strong>Imp√©ratif :</strong> Passer le m√™me <code>id</code> au FormField et au BaseInput.</li>
      <li>Utiliser le slot scope <code>describedBy</code> pour lier l'erreur ou l'aide √† l'input.</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Bon exemple (Liaison compl√®te) :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField 
  id="email" 
  label="Email" 
  help-text="Votre email pro"
>
  <template #default="{ describedBy }">
    <BaseInput 
      id="email" 
      :aria-describedby="describedBy" 
    />
  </template>
</FormField>`}
        </pre>
    </div>
  </div>

  <div style={{ background: '#fef2f2', border: '1px solid #fecaca', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#991b1b', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚ùå √Ä ne pas faire (Don't)</p>
    <ul>
      <li>Ne pas oublier l'ID sur l'input (sinon cliquer sur le label ne donne pas le focus).</li>
      <li>Ne pas utiliser ce composant pour une <code>Checkbox</code> ou un <code>Switch</code> (ils ont leur propre label).</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Mauvais exemple :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField id="nom" label="Nom">
  <BaseInput /> 
</FormField>`}
        </pre>
    </div>
  </div>

</div>

#### 2. Validation & Feedback

<div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px', marginTop: '20px' }}>
  
  <div style={{ background: '#f0fdf4', border: '1px solid #bbf7d0', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#166534', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚úÖ √Ä faire (Do)</p>
    <ul>
      <li>Utiliser la prop <code>error-message</code> plut√¥t que de changer manuellement la couleur du label.</li>
      <li>Accompagner l'√©tat d'erreur d'une ic√¥ne dans l'input (ex: <code>icon-right="warning"</code>) pour les daltoniens.</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Bon exemple :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField 
  error 
  error-message="Champ requis"
>
  <BaseInput error icon-right="warning" />
</FormField>`}
        </pre>
    </div>
  </div>

  <div style={{ background: '#fef2f2', border: '1px solid #fecaca', padding: '15px', borderRadius: '8px' }}>
    <p style={{ color: '#991b1b', marginTop: 0, fontSize: '24px', fontWeight: 'bold' }}>‚ùå √Ä ne pas faire (Don't)</p>
    <ul>
      <li>Ne pas afficher une erreur g√©n√©rique (ex: "Erreur") sans explication.</li>
      <li>Ne pas compter uniquement sur la couleur rouge pour indiquer l'erreur (inaccessible).</li>
    </ul>
    <div style={{ marginTop: '10px' }}>
        <strong>Mauvais exemple :</strong>
        <pre style={{ background: '#fff', padding: '10px', borderRadius: '4px', border: '1px solid #ddd', fontSize: '12px' }}>
{`<FormField error error-message="Erreur !">
  <BaseInput error /> 
</FormField>`}
        </pre>
    </div>
  </div>

</div>
---

### Accessibilit√©

L'accessibilit√© est la raison d'√™tre principale de ce composant wrapper. Voici comment il fonctionne :

* **Association Label/Input (`for` & `id`)** : 
  Le composant g√©n√®re un `<label for="X">`. Il est **crucial** que l'input enfant ait `id="X"`. Cela permet aux lecteurs d'√©cran d'annoncer le nom du champ et permet aux utilisateurs de cliquer sur le label pour activer le champ.

* **Description (`aria-describedby`)** : 
  Les textes d'aide (`help-text`) et les messages d'erreur (`error-message`) re√ßoivent automatiquement des IDs uniques (ex: `field-demo-help`).
  Le composant expose ces IDs via le slot scope `{ describedBy }`. Vous **devez** lier ces IDs √† l'input via `:aria-describedby="describedBy"`. 
  > *R√©sultat :* Quand l'utilisateur focus l'input, le lecteur d'√©cran lira : "Email, √©dition de texte. Votre email pro".

* **Validation (`aria-invalid`)** :
  Pensez √† passer la prop `error` ou `aria-invalid="true"` √† l'input enfant lorsque le FormField est en erreur.